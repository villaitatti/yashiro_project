<rs-text-annotation-type
                         label="Person"
                         rdf-type='https://yashiro.itatti.harvard.edu/yashiro/annotation/Person'
                         icon-url='/images/dpub/actor.svg'
                         color="#F9690E">

  <template id='annotation'>
    <div class="yashiro-annotation-person-container">
      <semantic-query
                      query='SELECT DISTINCT ?value ?label WHERE {
                BIND({{iri}} as ?iri)
                ?iri oa:hasBody ?body.
                ?body crm:P1_is_identified_by ?value.
                ?value rdfs:label ?label
            }' template='{{> show}}'>
        <template id='show'>
          <div class="yashiro-annotation-content concept">
            <semantic-query
                            query='SELECT DISTINCT ?localImage WHERE {<{{bindings.0.value.value}}> crm:P138i_has_representation ?filename.
                  BIND(REPLACE(STR(?filename),"https://yashiro.itatti.harvard.edu/","/assets/") as ?localImageNorm)
                  BIND(REPLACE(?localImageNorm,"/assets/resource/assets/","/assets/") as ?localImage) }LIMIT 1'
                            template='{{> thumbTemplate }}'>
              <template id='thumbTemplate'>
                {{#each bindings}}
                <img class="person-img" height="60px" src="{{localImage.value}}" />
                {{/each}}
              </template>
            </semantic-query>
            {{#> yashiro:AnnotationTemplate}}
            <semantic-link iri="{{bindings.0.value.value}}">{{bindings.0.label.value}}</semantic-link>
            {{/ yashiro:AnnotationTemplate}}
          </div>
          <div class="yashiro-annotation-person-info">
            <semantic-query
                            query='SELECT DISTINCT ?info WHERE { <{{bindings.0.value.value}}>  <http://www.cidoc-crm.org/cidoc-crm/P70i_is_documented_in> ?subtitle_node .
                        ?subtitle_node rdf:value ?info .}LIMIT 10'
                            template='{{> documentedIn }}'>
              <template id='documentedIn'>
                {{#each bindings}}
                <div class="annotation-subtitle">{{info.value}}</div>
                {{/each}}
              </template>
            </semantic-query>
          </div>
        </template>
      </semantic-query>
    </div>
  </template>

  <semantic-form-composite-input
                                 for='oaHasBody'
                                 new-subject-template='body'
                                 fields='[[fieldDefinitions
              annotation_person="https://y.itatti.harvard.edu/container/fieldDefinitionContainer/annotation_person"
              annotation_type="https://y.itatti.harvard.edu/container/fieldDefinitionContainer/annotation_type"
              annotation_label="https://y.itatti.harvard.edu/container/fieldDefinitionContainer/annotation_label"
          ]]'>
    <semantic-form-autocomplete-input for="annotation_person"></semantic-form-autocomplete-input>
    <semantic-form-hidden-input for='annotation_label' append-value='[[singleValueFromSelect "SELECT ?user WHERE { BIND(?__useruri__ as ?user) }" ]]'></semantic-form-hidden-input>
    <semantic-form-hidden-input for='annotation_type' default-value='https://yashiro.itatti.harvard.edu/yashiro/annotation:Person'></semantic-form-hidden-input>
  </semantic-form-composite-input>

</rs-text-annotation-type>
